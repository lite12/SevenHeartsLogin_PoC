function buildWeak() {
var $weak='';
$weak=$weak+'a';
$weak=$weak+'b';
$weak=$weak+'c';
$weak=$weak+'d';
$weak=$weak+'e';
$weak=$weak+'f';
$weak=$weak+'g';
$weak=$weak+'h';
$weak=$weak+'i';
$weak=$weak+'j';
$weak=$weak+'k';
$weak=$weak+'l';
$weak=$weak+'m';
$weak=$weak+'n';
$weak=$weak+'o';
$weak=$weak+'p';
$weak=$weak+'q';
$weak=$weak+'r';
$weak=$weak+'s';
$weak=$weak+'t';
$weak=$weak+'u';
$weak=$weak+'v';
$weak=$weak+'w';
$weak=$weak+'x';
$weak=$weak+'y';
$weak=$weak+'z';
return $weak;
}

function buildMedium() {
var $medium='';
$medium=$medium+'0';
$medium=$medium+'1';
$medium=$medium+'2';
$medium=$medium+'3';
$medium=$medium+'4';
$medium=$medium+'5';
$medium=$medium+'6';
$medium=$medium+'7';
$medium=$medium+'8';
$medium=$medium+'9';
$medium=$medium+'A';
$medium=$medium+'B';
$medium=$medium+'C';
$medium=$medium+'D';
$medium=$medium+'E';
$medium=$medium+'F';
$medium=$medium+'G';
$medium=$medium+'H';
$medium=$medium+'I';
$medium=$medium+'J';
$medium=$medium+'K';
$medium=$medium+'L';
$medium=$medium+'M';
$medium=$medium+'N';
$medium=$medium+'O';
$medium=$medium+'P';
$medium=$medium+'Q';
$medium=$medium+'R';
$medium=$medium+'S';
$medium=$medium+'T';
$medium=$medium+'U';
$medium=$medium+'V';
$medium=$medium+'W';
$medium=$medium+'X';
$medium=$medium+'Y';
$medium=$medium+'Z';
return $medium;
}

function buildStrong() {
var $strong='';
$strong=$strong+'!';
$strong=$strong+'!';
$strong=$strong+'#';
$strong=$strong+'$';
$strong=$strong+'%';
$strong=$strong+'&';
$strong=$strong+',';
$strong=$strong+'.';
$strong=$strong+':';
$strong=$strong+'-';
$strong=$strong+'­';
$strong=$strong+'­';
$strong=$strong+'–';
$strong=$strong+'—';
$strong=$strong+';';
$strong=$strong+'?';
$strong=$strong+'@';
$strong=$strong+'[';
$strong=$strong+']';
$strong=$strong+'^';
$strong=$strong+'ˆ';
$strong=$strong+'_';
$strong=$strong+'{';
$strong=$strong+'|';
$strong=$strong+'}';
$strong=$strong+'~';
$strong=$strong+'¡';
$strong=$strong+'¡';
$strong=$strong+'¦';
$strong=$strong+'¦';
$strong=$strong+'¨';
$strong=$strong+'¨';
$strong=$strong+'¯';
$strong=$strong+'¯';
$strong=$strong+'¸';
$strong=$strong+'¸';
$strong=$strong+'¿';
$strong=$strong+'¿';
$strong=$strong+'˜';
$strong=$strong+'‚';
$strong=$strong+'„';
$strong=$strong+'‹';
$strong=$strong+'›';
$strong=$strong+'›';
$strong=$strong+'+';
$strong=$strong+'<';
$strong=$strong+'=';
$strong=$strong+'>';
$strong=$strong+'±';
$strong=$strong+'±';
$strong=$strong+'«';
$strong=$strong+'«';
$strong=$strong+'»';
$strong=$strong+'»';
$strong=$strong+'×';
$strong=$strong+'×';
$strong=$strong+'÷';
$strong=$strong+'÷';
$strong=$strong+'¢';
$strong=$strong+'¢';
$strong=$strong+'£';
$strong=$strong+'£';
$strong=$strong+'¤';
$strong=$strong+'¤';
$strong=$strong+'¥';
$strong=$strong+'¥';
$strong=$strong+'§';
$strong=$strong+'§';
$strong=$strong+'©';
$strong=$strong+'©';
$strong=$strong+'¬';
$strong=$strong+'¬';
$strong=$strong+'®';
$strong=$strong+'®';
$strong=$strong+'°';
$strong=$strong+'°';
$strong=$strong+'µ';
$strong=$strong+'µ';
$strong=$strong+'†';
$strong=$strong+'‡';
$strong=$strong+'•';
$strong=$strong+'…';
$strong=$strong+'‰';
$strong=$strong+'€';
$strong=$strong+'¼';
$strong=$strong+'¼';
$strong=$strong+'½';
$strong=$strong+'½';
$strong=$strong+'¾';
$strong=$strong+'¾';
$strong=$strong+'¹';
$strong=$strong+'¹';
$strong=$strong+'²';
$strong=$strong+'²';
$strong=$strong+'³';
$strong=$strong+'³';
$strong=$strong+'ª';
$strong=$strong+'ª';
$strong=$strong+'Á';
$strong=$strong+'á';
$strong=$strong+'À';
$strong=$strong+'à';
$strong=$strong+'Â';
$strong=$strong+'â';
$strong=$strong+'Ä';
$strong=$strong+'ä';
$strong=$strong+'Ã';
$strong=$strong+'ã';
$strong=$strong+'Å';
$strong=$strong+'å';
$strong=$strong+'Æ';
$strong=$strong+'æ';
$strong=$strong+'Ç';
$strong=$strong+'ç';
$strong=$strong+'Ð';
$strong=$strong+'ð';
$strong=$strong+'É';
$strong=$strong+'é';
$strong=$strong+'È';
$strong=$strong+'è';
$strong=$strong+'Ê';
$strong=$strong+'ê';
$strong=$strong+'Ë';
$strong=$strong+'ë';
$strong=$strong+'ƒ';
$strong=$strong+'Í';
$strong=$strong+'í';
$strong=$strong+'Ì';
$strong=$strong+'ì';
$strong=$strong+'Î';
$strong=$strong+'î';
$strong=$strong+'Ï';
$strong=$strong+'ï';
$strong=$strong+'Ñ';
$strong=$strong+'ñ';
$strong=$strong+'º';
$strong=$strong+'º';
$strong=$strong+'Ó';
$strong=$strong+'ó';
$strong=$strong+'Ò';
$strong=$strong+'ò';
$strong=$strong+'Ô';
$strong=$strong+'ô';
$strong=$strong+'Ö';
$strong=$strong+'ö';
$strong=$strong+'Õ';
$strong=$strong+'õ';
$strong=$strong+'Ø';
$strong=$strong+'ø';
$strong=$strong+'Œ';
$strong=$strong+'œ';
$strong=$strong+'Š';
$strong=$strong+'š';
$strong=$strong+'ß';
$strong=$strong+'Þ';
$strong=$strong+'þ';
$strong=$strong+'™';
$strong=$strong+'Ú';
$strong=$strong+'ú';
$strong=$strong+'Ù';
$strong=$strong+'ù';
$strong=$strong+'Û';
$strong=$strong+'û';
$strong=$strong+'Ü';
$strong=$strong+'ü';
$strong=$strong+'Ý';
$strong=$strong+'ý';
$strong=$strong+'Ÿ';
$strong=$strong+'ÿ';
$strong=$strong+'Ž';
$strong=$strong+'ž';
return $strong;
}
function buildIllegal() {
var $illegal='';
$illegal=$illegal+'(';
$illegal=$illegal+')';
$illegal=$illegal+'*';
$illegal=$illegal+"'";
$illegal=$illegal+'`';
$illegal=$illegal+'´';
$illegal=$illegal+'‘';
$illegal=$illegal+'’';
$illegal=$illegal+'“';
$illegal=$illegal+'"';
$illegal=$illegal+'”';
$illegal=$illegal+'¶';
$illegal=$illegal+'·';
$illegal=$illegal+'/';
$illegal=$illegal+'\\';
return $illegal;
}



function isWhat($ch,$what) {
// Searches for something, if it has it, it returns true...

var $isat=-1;

	if ($what=="illegal") {
	// Find if this is a strong char
	var $illegal=buildIllegal();
	$isat=$illegal.indexOf($ch);
	}
	
	if ($what=="strong") {
	// Find if this is a strong char
	var $strong=buildStrong();
	$isat=$strong.indexOf($ch);
	}
	
	if ($what=="medium") {
	// Find if this is a strong char
	var $medium=buildMedium();
	$isat=$medium.indexOf($ch);
	}
	
	if ($what=="weak") {
	// Find if this is a strong char
	var $weak=buildWeak();
	$isat=$weak.indexOf($ch);
	}

if ($isat>-1) {
return true;
}
if ($isat==-1) {
return false;
}

}

function updateStrength() {
var $score='weak';

var $pw = form.password.value;

// Takes current PW, and loads it into the slicer
var $ch='';
var $isweak='';
var $isstrong='';
var $ismedium='';
var $isillegal='';

var $highest='';

var $divnum=0;

$divnum=$pw * 1;

	if ($divnum==$pw) {
	$highest='weak';
	$score='weak';
	} else {
			
	for ($x=0; $x < $pw.length; $x++) {
		
		$ch=$pw.charAt($x);
		$isillegal=isWhat($ch,'illegal');
		$isstrong=isWhat($ch,'strong');
		$ismedium=isWhat($ch,'medium');
		$isweak=isWhat($ch,'weak');
		
			if ($isillegal==true) {
			// contains an illegal character, we don't want these in our systems!
			// prompt the user, letting them know they entered an illegal character
			$isresult='illegal';
			$highest='illegal';
			}
			if ($isstrong==true) {
			// contains a weak character
			$isresult='strong';
				if ($highest=='illegal') {
				} else {
				$highest='strong';
				}
			}
			if ($ismedium==true) {
			// contains a weak character
			$isresult='medium';
				if ($highest=='illegal') {
				} else {
					if ($highest=='strong') {
					} else {
					$highest='medium';
					}
				}
			}
			if ($isweak==true) {
			// contains a weak character
			$isresult='weak';
				if ($highest=='illegal') {
				} else {
					if ($highest=='strong') {
					} else {
						if ($highest=='medium') {
						} else {
						$highest='weak';
						}
					}
				}
			} 
		} // for x
	} // check for div * 1


if ($highest=='illegal') {
alert('The character you entered cannot be part of your password. Please enter a new password, without this character: '+$ch+'.');
$score='illegal';
form.password.value=''; // This will reset the field, because illegal characters aren't wanted.
document.images["strength"].src="themes/junon/images/10.gif";
} else {
$score=$highest;
	if ($highest=="illegal") {
	document.images["strength"].src="themes/junon/images/10.gif";
	}
	if ($highest=="strong") {
	document.images["strength"].src="themes/junon/images/100.gif";
	}
	if ($highest=="medium") {
	document.images["strength"].src="themes/junon/images/50.gif";
	}
	if ($highest=="weak") {
	document.images["strength"].src="themes/junon/images/20.gif";
	}
}


// If it contains 4 or more characters, allow over weak
$len=$pw.length;

if ($len<4) {
$score='weak';
document.images["strength"].src="themes/junon/images/10.gif";
}

if ($len>10) {
	if ($score=='weak') {
	// Well... it's weak, but it has 10 characters.. Seems pretty tough to me?
	document.images["strength"].src="themes/junon/images/50.gif";
	$score='medium';
	}
}
if ($len>30) {
	if ($score=='medium') {
	document.images["strength"].src="themes/junon/images/100.gif";
	$score='strong';
	}
}
if ($len>40) {
	if ($score=='strong') {
	document.images["strength"].src="themes/junon/images/10.gif";
	alert('Your password is too long. Please choose a shorter password (1 to 40 characters long).');
	$score='illegal';
	form.password.value='';

	}
}

document.form.allChars.value=$score;
}

/*
     FILE ARCHIVED ON 16:48:02 Oct 13, 2007 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 04:04:52 Jan 04, 2018.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
*/